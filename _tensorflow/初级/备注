è®¾è®¡ä¸åŒå±‚æ•°ã€å¤§å°çš„ç½‘ç»œæ¨¡åž‹å¯ä»¥ä¸ºä¼˜åŒ–ç®—æ³•æä¾›åˆå§‹çš„å‡½æ•°å‡è®¾ç©ºé—´
ä½†æ˜¯æ¨¡åž‹çš„å®žé™…å®¹é‡å¯ä»¥éšç€ç½‘ç»œå‚æ•°çš„ä¼˜åŒ–æ›´æ–°è€Œäº§ç”Ÿå˜åŒ–
âˆ‘Î³Î©Ï†ÏƒÏ‰Î¸Î»Î´âˆ‚ ÎµÅ‹ Î±
y = ð›½0 + ð›½1ð‘¥ + ð›½2ð‘¥2 + ð›½3ð‘¥3 + â‹¯ + ð›½ð‘›ð‘¥ð‘› +Îµ
æ¨¡åž‹çš„å®¹é‡å¯ä»¥é€šè¿‡ð‘›ç®€å•è¡¡é‡ï¼Œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­å¦‚æžœç½‘ç»œå‚æ•°ð›½ð‘˜+1, . . . , ð›½ð‘› = 0ï¼Œé‚£ä¹ˆç½‘ç»œçš„å®žé™…å®¹é‡é€€åŒ–åˆ°ð‘˜æ¬¡
é€šè¿‡é™åˆ¶ç½‘ç»œå‚æ•°çš„ç¨€ç–æ€§ï¼Œå¯ä»¥æ¥çº¦æŸç½‘ç»œçš„å®žé™…å®¹é‡
ð‘€ð‘–ð‘›ð‘–ð‘šð‘–ð‘§ð‘’ â„’(ð‘“ðœƒ(x),ð‘¦), (x,ð‘¦) âˆˆ ð”»ð‘¡ð‘Ÿð‘Žð‘–ð‘› --> ð‘€ð‘–ð‘›ð‘–ð‘šð‘–ð‘§ð‘’ â„’(ð‘“ðœƒ(x), ð‘¦) + ðœ† âˆ— ð›º(ðœƒ), (x, ð‘¦) âˆˆ ð”»ð‘¡ð‘Ÿð‘Žð‘–ð‘›
å…¶ä¸­ð›º(ðœƒ)è¡¨ç¤ºå¯¹ç½‘ç»œå‚æ•°ðœƒçš„ç¨€ç–æ€§çº¦æŸå‡½æ•°ï¼Œä¸€èˆ¬ä½¿ç”¨çº¦æŸðœƒçš„ð¿èŒƒæ•°å®žçŽ° ð›º(ðœƒ) = âˆ‘â€–ðœƒð‘–â€–ð‘™
è¾ƒå¤§çš„ðœ†æ„å‘³ç€ç½‘ç»œçš„ç¨€ç–æ€§æ›´é‡è¦ï¼›è¾ƒå°çš„ðœ†åˆ™æ„å‘³ç€ç½‘ç»œçš„è®­ç»ƒè¯¯å·®æ›´é‡è¦

(1) æ—©æœŸåœæ­¢æŠ€æœ¯ tf.keras.callbacks.EarlyStopping
è¿žç»­å¤šä¸ªå‘¨æœŸéªŒè¯é›†çš„ç›‘æŽ§æŒ‡æ ‡æ²¡æœ‰æå‡æ—¶å°±ä¼šåœæ­¢è®­ç»ƒ

(2) æ­£åˆ™åŒ–æŠ€æœ¯
L0æ­£åˆ™åŒ–ï¼šé‡‡ç”¨ L0 èŒƒæ•°
ð›º(ðœƒ) = âˆ‘â€–ðœƒð‘–â€–0
L0 èŒƒæ•°â€–ðœƒð‘–â€–0 å®šä¹‰ä¸ºðœƒð‘–ä¸­éžé›¶å…ƒç´ çš„ä¸ªæ•° L0(vector)=Î£num(xiâ‰ 0) i=1,2,..n
loss_reg = tf.reduce_sum(tf.cast(tf.constant(w1),dtype=tf.bool))
+tf.reduce_sum(tf.cast(tf.constant(w2),dtype=tf.bool))
çº¦æŸâˆ‘ðœƒð‘–â€–ðœƒð‘–â€–0çš„å¤§å°å¯ä»¥è¿«ä½¿ç½‘ç»œä¸­çš„è¿žæŽ¥æƒå€¼å¤§éƒ¨åˆ†ä¸º 0ï¼Œä»Žè€Œé™ä½Žç½‘ç»œçš„å®žé™…å‚æ•°é‡å’Œç½‘ç»œå®¹é‡
ä½†æ˜¯L0èŒƒæ•°ä¸å¯å¯¼ï¼Œä¸å¯é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ³•ä¼˜åŒ–å¾ˆå°‘ä½¿ç”¨

L1æ­£åˆ™åŒ–ï¼šé‡‡ç”¨ L1 èŒƒæ•°
L1 èŒƒæ•°â€–ðœƒð‘–â€–1å®šä¹‰ä¸ºå¼ é‡ðœƒð‘–ä¸­æ‰€æœ‰å…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œ  vector=[x1,x2,...,xn] L1(vector)=Î£(xi) i=1,2,..,n
L1 æ­£åˆ™åŒ–ä¹Ÿå« Lasso Regularizationï¼Œå®ƒæ˜¯è¿žç»­å¯å¯¼çš„
eg:
w1 = tf.random.normal([4,3])
w2 = tf.random.normal([4,3])
# è®¡ç®—æ¯ä¸ªå‚æ•°çš„L1èŒƒæ•°ï¼Œå†å¯¹æ‰€æœ‰å‚æ•°çš„L1èŒƒæ•°æ±‚å’Œ
loss_reg = tf.reduce_sum(tf.math.abs(w1))+tf.reduce_sum(tf.math.abs(w2))

L2æ­£åˆ™åŒ–ï¼šé‡‡ç”¨ L2 èŒƒæ•°
L2 èŒƒæ•°â€–ðœƒð‘–â€–2å®šä¹‰ä¸ºå¼ é‡ðœƒð‘–ä¸­æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å’Œ L2(vector)=Î£(xi^2) i=1,2,..,n
loss_reg = tf.reduce_sum(tf.square(w1))+ tf.reduce_sum(tf.square(w2))

(3) DropoutæŠ€æœ¯
tf.nn.dropout(x, rate)å®žçŽ°æŸæ¡è¿žæŽ¥çš„ Dropout åŠŸèƒ½ï¼Œå…¶ä¸­ rate å‚æ•°è®¾ç½®æ–­å¼€çš„æ¦‚çŽ‡å€¼ p
å…¶ä»–å…ƒç´ åˆ™æŒ‰ç…§1/(1-rate)è¿›è¡Œæ”¾å¤§
x = tf.nn.dropout(x, rate=0.5)
ä¹Ÿå¯ä»¥å°† Dropout ä½œä¸ºä¸€ä¸ªç½‘ç»œå±‚ä½¿ç”¨ï¼Œåœ¨ç½‘ç»œä¸­é—´æ’å…¥ä¸€ä¸ª Dropout å±‚
model.add(layers.Dropout(rate=0.5))
ç›´æŽ¥åˆ›å»ºå±‚å†æ·»åŠ ä¹Ÿå¯
layer = tf.keras.layers.Dropout(rate, noise_shape=None, seed=None)
model.add(layer)
Dropout é€šè¿‡éšæœºæ–­å¼€ç¥žç»ç½‘ç»œçš„è¿žæŽ¥ï¼Œå‡å°‘æ¯æ¬¡è®­ç»ƒæ—¶å®žé™…å‚ä¸Žè®¡ç®—çš„æ¨¡åž‹çš„å‚æ•°é‡
åœ¨æµ‹è¯•æ—¶ï¼ŒDropout ä¼šæ¢å¤æ‰€æœ‰çš„è¿žæŽ¥ï¼Œä¿è¯æ¨¡åž‹æµ‹è¯•æ—¶èŽ·å¾—æœ€å¥½çš„æ€§èƒ½

(4) æ•°æ®å¢žå¼ºæŠ€æœ¯(Data Augmentation)
ç»´æŒæ ·æœ¬æ ‡ç­¾ä¸å˜ï¼Œæ ¹æ®å…ˆéªŒçŸ¥è¯†æ”¹å˜æ ·æœ¬ç‰¹å¾ï¼Œä½¿æ–°äº§ç”Ÿçš„æ ·æœ¬ä¹Ÿç¬¦åˆç¬¦åˆæ•°æ®çš„çœŸå®žåˆ†å¸ƒ
ä¾‹å¦‚å¯¹äºŽå›¾ç‰‡æ•°æ®å¯¹å…¶æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ã€è£å‰ªã€æ”¹å˜è§†è§’ã€é®æŒ¡æŸå±€éƒ¨åŒºåŸŸä¸ä¼šæ”¹å˜å›¾ç‰‡çš„ç±»åˆ«æ ‡ç­¾

ä¸Žå½“å‰åƒç´ æ¬§å¼è·ç¦»â‰¤k/âˆš2çš„åƒç´ ç‚¹é‡è¦æ€§è¾ƒé«˜ï¼Œï¼žk/âˆš2åƒç´ ç‚¹é‡è¦æ€§è¾ƒä½Ž
æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹ä»…ä¸Žæ„Ÿå—é‡ŽåŒºåŸŸå†… k*k ä¸ªè¾“å…¥èŠ‚ç‚¹ç›¸è¿žæŽ¥ è€Œéžå…¨è¿žæŽ¥input_shape*input_shape
æ­¤æ—¶æ€»çš„å‚æ•°é‡ä¸ºk*k*dout ä¾‹å¦‚(28*28)*256 --->(10*10)*256 æœ‰2560ä¸ªå‚æ•°
è¿™æ˜¯å› ä¸ºæ¯ä¸ªè¾“å…¥èŠ‚ç‚¹åˆ°æ¯ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„æƒå€¼å‚æ•°éƒ½ä¸åŒï¼Œå¦‚æžœè®©å…¶ç›¸ç­‰
æƒå€¼å…±äº«æ¯ä¸ªè¾“å…¥èŠ‚ç‚¹åˆ°æ‰€æœ‰è¾“å‡ºèŠ‚ç‚¹çš„å‚æ•°éƒ½ç›¸åŒï¼Œé‚£ä¹ˆç›¸å½“äºŽå‚æ•°é‡å˜æˆ1ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„å‚æ•°é‡å³k*k

f(x)*g(x)=Î£f(Ï„)g(x-Ï„)=âˆ«f(Ï„)g(x-Ï„)dÏ„(Ï„,-âˆž,+âˆž)
f(x,y)*g(x,y)=Î£Î£f(m,n)g(x-m,y-n)=âˆ«f(m,n)g(x-m,y-n)dmdn (m,n,-âˆž,+âˆž)
äºŒç»´å·ç§¯åè½¬ : åšä¸€æ¬¡å·¦å³å¯¹ç§°åè½¬å’Œä¸€æ¬¡ä¸Šä¸‹å¯¹ç§°åè½¬
[ a, b, c ]        [ i, h, g ]
[ d, e, f ]  --->  [ f, e, d ]
[ g, h, i ]        [ c, b, a ]

å…ˆå‘å³å¹³ç§»å†åè½¬ç­‰ä»·äºŽå…ˆåè½¬å†å‘å·¦å¹³ç§»
ä¾‹å¦‚å¯¹äºŽ3Ã—3çš„å›¾åƒå’Œ3Ã—3çš„å·ç§¯æ ¸
F(-1,-1) = Î£Î£f(m,n)g(-1-m,-1-n) å¯ä»¥å…ˆå–å®šä¹‰åŸŸ-1â‰¤-1-m,-1-nâ‰¤1å¾—åˆ°-1â‰¤m,nâ‰¤0
å®žé™…ä¸ŠF(-1,-1)=f(0,0)g(-1,-1)+f(-1,0)g(0,-1)+f(0,-1)g(-1,0)+f(-1,-1)g(0,0)
å›¾åƒæ•°æ®å’Œå·ç§¯æ ¸æ•°æ®åˆ†åˆ«ä¸º å–å‘å³å’Œå‘ä¸‹æ­£æ–¹å‘ï¼Œåæ ‡ä½ç½®ä¸º
[ 2, 3, 1 ]        [ 0, -1, 0 ]         (-1,-1) (0,-1) (1,-1)
[ 0, 5, 1 ]    *   [ -1, 5, -1 ]        (-1,0) (0,0) (1,0)
[ 1, 0, 8 ]        [ 0, -1, 0 ]         (-1,1) (0,1) (1,1)
åˆ™F(-1,-1)=5*0+0*(-1)+3*(-1)+2*5=7 åŽç»­ä¾æ¬¡è®¡ç®—F(0,-1)=7,F(1,-1)=1,F(-1,0)=-8,
F(0,0)=21,F(1,0)=-9,F(-1,1)=5,F(0,1)=-14,F(1,1)=39
å¯ä»¥å°†g(-1-m,-1-m)ç†è§£ä¸ºå¯¹g(m.n)å…ˆåè½¬ä¸ºg(-m,-n)å†ç›¸åæ–¹å‘å¹³ç§»ï¼Œå³å‘å·¦å’Œä¸Šæ–¹å¹³ç§»1ä¸ªå•ä½
(0)    (-1)    (0)                    (0)    (-1)    (0)                       (0)    (-1)    (0)
(-1)   (5)2     (-1)3    1  ==>       (-1)2   (5)3    (-1)1    ==>        2    3(-1)   1(5)   (-1)
(0)    (-1)0    (0)5     1            (0)0    (-1)5    (0)1               0    5(0)    1(-1)  (0)
           1       0     8               1        0       8               1    0       8

(0)    2(-1)     3(0)    1
(-1)   0(5)     5(-1)    1  ==>
(0)    1(-1)    0(0)     8


æ ‡å‡†åŒ–æ•°æ®ï¼šsigmoidçš„å¯¼æ•°åœ¨x>2æˆ–x<-2çš„èŒƒå›´éžå¸¸å°ï¼Œå®¹æ˜“å‡ºçŽ°æ¢¯åº¦å¼¥æ•£ï¼Œæ•…æœ‰å¿…è¦å°†è¾“å…¥æ•°æ®å½’ä¸€åŒ–åˆ°[-1,1]
å†å¦‚ L =w1 * x1 + w2 * x2 + b Lå¯¹w1å’Œw2çš„åå¯¼ä¸ºx1å’Œx2 å¦‚æžœx1å’Œx2ç›¸è¿‘é‚£ä¹ˆæ¢¯åº¦ä¼˜åŒ–æ–¹å‘æŽ¥è¿‘äºŽy=xç›´è¾¾æžå€¼ç‚¹ å¦åˆ™ä¼šé™¡å³­
ç½‘ç»œå±‚è¾“å…¥ð‘¥åˆ†å¸ƒç›¸è¿‘ï¼Œå¹¶ä¸”åˆ†å¸ƒåœ¨è¾ƒå°èŒƒå›´å†…æ—¶(å¦‚ 0 é™„è¿‘)ï¼Œæ›´æœ‰åˆ©äºŽå‡½æ•°çš„ä¼˜åŒ–





